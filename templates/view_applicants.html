<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View Applicants</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/dashboard.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:100" rel="stylesheet">
</head>

<body>

    <div class="container mt-5">

        <h2 class="mb-4">Applicants for {{ job.title }}</h2>

        <!-- Sort Form -->
        <div class="row mb-3">
            <div class="col-md-0">
                <label for="sort_order">Filter by Score</label>
                <select name="sort_order" id="sort_order" class="form-control" style="width: fit-content;" onchange="sortApplicants()">
                    <option value="asc">Lowest First</option>
                    <option value="desc">Highest First</option>
                </select>
            </div>
        </div>

        <!-- Applicant List -->
        <ul class="list-group" id="applicantList">
            {% for applicant, ratio in correct_answers_ratio %}
                <li class="list-group-item">
                    {{ applicant.name }} - {{ applicant.email }} - {{ applicant.phone }} - {{ applicant.previous_job }} - {{ applicant.previous_job_location }} -
                    <div class="badge bg-secondary rounded-pill">Score {{ ratio|as_fraction }}</div>
                    <a href="{{ url_for('view_job_applicant', job_id=job.id, applicant_id=applicant.id) }}" class="btn btn-info btn-sm float-right">View More</a>
                    <a href="#" class="btn btn-danger btn-sm float-right">Delete Applicant</a>
                </li>
            {% endfor %}
        </ul>

        <a href="{{ url_for('jobs_dashboard') }}" class="btn btn-primary mt-3">Back to Jobs Dashboard</a>
    </div>

    <!-- JavaScript for Sort Applicants -->
    <script>
        function sortApplicants() {
            var sortOrder = document.getElementById('sort_order').value;
            var applicantList = document.getElementById('applicantList');
            var applicants = Array.from(applicantList.getElementsByClassName('list-group-item'));

            applicants.sort(function (a, b) {
                var scoreA = parseFloat(a.querySelector('.badge').textContent.replace('Score ', ''));
                var scoreB = parseFloat(b.querySelector('.badge').textContent.replace('Score ', ''));

                if (sortOrder === 'asc') {
                    return scoreA - scoreB;
                } else {
                    return scoreB - scoreA;
                }
            });

            for (var i = 0; i < applicants.length; i++) {
                applicantList.appendChild(applicants[i]);
            }
        }
    </script>

</body>

</html>
